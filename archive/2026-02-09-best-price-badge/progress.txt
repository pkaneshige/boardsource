# Ralph Progress Log - Best Price Badge

## Codebase Patterns
- Use `sanityFetch` for reading from Sanity CMS
- Use `sanityWriteClient` for writing to Sanity CMS
- Scraper types go in `lib/scraper/types.ts` or source-specific types files
- Source-specific scrapers go in `lib/scraper/[source-name]/` folders
- API routes use x-api-key header authentication via `SYNC_API_KEY` env var
- URL-based filters: use client component with useSearchParams/useRouter for interactive controls, server component builds GROQ query from searchParams
- Next.js 15 searchParams in pages are Promises: use `const params = await searchParams;`
- Existing Badge component at components/ui/badge.tsx with variants: default, success, warning, error, info
- Product cards defined as ProductCard component in app/surfboards/page.tsx
- Product detail page at app/surfboards/[slug]/page.tsx with relatedListings already resolved via GROQ
- Filter controls in app/surfboards/filter-controls.tsx using URL search params
- Sort options in app/surfboards/sort-select.tsx
- GROQ dereference: relatedListings[]->{ fields } to resolve references

---

